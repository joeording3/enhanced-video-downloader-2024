#!/usr/bin/env python
"""
This wrapper script ensures that videodownloader-server is easily accessible
when installed via pip. It locates and runs the actual script.
"""
import importlib.util
import os
import sys


def find_module_path(module_name):
    """Find the path of a module that can be imported."""
    try:
        spec = importlib.util.find_spec(module_name)
        if spec is not None:
            return spec.origin
    except (ImportError, AttributeError):
        pass
    return None

def main():
    """Run the videodownloader-server CLI."""
    try:
        # Try to import server.cli_main directly
        from server.cli_main import cli
        cli()
    except ImportError:
        # If direct import fails, try running as module
        server_path = find_module_path('server')
        if server_path:
            # Get the directory containing the server module
            server_dir = os.path.dirname(server_path)
            # Add the parent directory to sys.path
            parent_dir = os.path.dirname(server_dir)
            if parent_dir not in sys.path:
                sys.path.insert(0, parent_dir)
            # Now try importing again
            try:
                from server.cli_main import cli
                cli()
            except ImportError as e:
                print(f"Error importing server.cli_main module: {e}")
                sys.exit(1)
        else:
            print("Could not find the videodownloader-server package. "
                  "Please ensure it is installed correctly.")
            sys.exit(1)

if __name__ == "__main__":
    main()
